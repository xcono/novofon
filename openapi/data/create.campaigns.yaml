openapi: 3.0.0
info:
  title: Создание рекламной кампании
  version: 1.0.0
  description: Создание рекламной кампании
paths:
  /create.campaigns:
    post:
      summary: Создание рекламной кампании
      description: 'Создание рекламной кампании


        **Доступ:** Агент, Клиент


        **Параметры запроса:** 22


        - `access_token` (string) (обязательный): Ключ сессии аутентификации


        - `user_id` (number) (опциональный): Уникальный идентификатор пользователя
        клиента агента от имени которого делается запрос


        - `name` (string) (обязательный): Название рекламной кампании


        - `description` (string) (опциональный): Описание рекламной кампании


        - `status` (enum) (опциональный): Статус рекламной кампании


        - `site_id` (number) (обязательный): Уникальный идентификатор сайта


        - `campaign_conditions` (object) (опциональный): Условия рекламной кампании.


        - `site_blocks` (array) (опциональный): Настройки привязки номера к блоку
        на сайте Если блоки номеров сайта не указаны, то они не настраиваются, т.е.
        считаются не настроенными Если site_blocks задан одновременно с status = inactive,
        то будет возвращаться ошибка `invalid_parameters_combination`


        - `site_block_id` (number) (обязательный): Уникальный идентификатор блока
        номеров


        - `phone_number_id` (number) (обязательный): Уникальный идентификатор виртуального
        номера. Чтобы получить список доступных виртуальных номеров необходимо использовать
        метод get.campaign_available_phone_numbers Если указан id который не возвращается
        методом get.campaign_available_phone_numbers, то будет возвращена ошибка с
        мнемоникой "entity_not_found". Номер с type = call_tracking может использоваться
        только в одной рекламной кампании. Если номер уже используется в другой рекламной
        кампании, то будет возвращена ошибка `already_in_use`


        - `redirection_phone_number_id` (number) (опциональный): Уникальный идентификатор
        номера переадресации. Номер переадресации используется только в том случае,
        если параметр phone_number_id имеет тип `call_tracking`. Список доступных
        номеров можно получить методом get.campaign_available_redirection_phone_numbers.
        Обязателен для заполнения, если в параметре phone_number_id указан виртуальный
        номер с типом "call_tracking". Если это не так, то будет возвращена ошибка
        с мнемоникой "required_parameter_missed". Если параметр задан и в phone_number_id
        указан виртуальный номер с типом "va", то будет возвращаться ошибка `invalid_parameters_combination`
        В параметре могут быть указаны только номера переадресации, которые возвращаются
        методом get.campaign_available_redirection_phone_numbers. Если это не так,
        то будет возвращаться ошибка с мнемоникой "invalid_parameter_value" Доступен,
        если подключен компонент "va". Если параметр будет заполнен и у вас отсутствует
        компонент "va", то будет возвращена ошибка с мнемоникой "parameter_component_disabled"


        - `dynamic_call_tracking_enabled` (boolean) (опциональный): Активация динамический
        коллтрекинг. В пул динамического коллтрекинга можно подключить только свободные
        номера без флага "Использовать в ВАТС" в том же коде, что и номер блока рекламной
        кампании по умолчанию. При отсутствии необходимого количества номеров они
        будут автоматически куплены. Звонки на номера из пула динамического коллтрекинга
        будут обрабатываться по правилам обработки звонков на номер блока рекламной
        кампании по умолчанию. Может принимать значение "true", если параметр phone_number_id
        = va | call_tracking. Если это не так, то будет возвращена ошибка с мнемоникой
        "invalid_parameters_combination" Если Вы используете этот параметр, но у вас
        не подключен компонент "dynamic_call_tracking", то Вам вернется ошибка с мнемоникой
        "parameter_component_disabled" Если задан одновременно status = inactive,
        то будет возвращена ошибка `invalid_parameters_combination` Если параметр
        dynamic_call_tracking_enabled имеет значение "true", то параметр dynamic_call_tracking
        обязателен к заполнению. Будет возвращена ошибка "invalid_parameters_combination".


        - `dynamic_call_tracking` (object) (опциональный): Настройка динамический
        коллтрекинг. Обязателен к заполнению, если параметр dynamic_call_tracking_enabled
        у хоть одного блока имеет значение "true" иначе будет возвращена ошибка с
        мнемоникой "invalid_parameters_combination" Если Вы используете этот параметр,
        но у вас не подключен компонент "dynamic_call_tracking", то Вам вернется ошибка
        с мнемоникой "parameter_component_disabled"


        - `reservation_time` (enum) (опциональный): Значение по умолчанию "15m". Период,
        на который номер закрепляется за посетителем сайта. По истечении указанного
        времени номер закрепляется за новым посетителем (или остается за текущим в
        случае наличия свободных номеров коллтрекинга).


        - `count_virtual_numbers` (number) (обязательный): Количество номеров необходимое
        для работы динамического коллтрекинга в одном блоке. Указанное количество
        номеров будет куплено.


        - `count_visits` (number) (обязательный): Количество посещений по рекламной
        кампании в сутки


        - `group_conditions` (array) (обязательный): Группа условий рекламной кампании


        - `conditions` (array) (обязательный): Условия рекламной кампании в группе
        условий


        - `type` (enum) (обязательный): Условия рекламной кампании в группе условий
        include - включает exclude - исключает


        - `campaign_parameter` (enum) (обязательный): Список допустимых значений и
        возможных операторов см. в таблице "Список параметров и их операторов"


        - `value` (string) (обязательный): Значение. Для некоторых campaign_parameter
        может быть свой список допустимых значений см. в таблице "Список параметров
        и их операторов"


        - `operator` (enum) (обязательный): Оператор в условии. Зависит от используемого
        параметра campaign_parameter см. в таблице "Список параметров и их операторов"
        "=" - точно соответствует "sub" - включает "~" - регулярное выражение


        **Параметры ответа:** 1


        - `id` (number): Уникальный идентификатор рекламной кампании'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                jsonrpc:
                  type: string
                  example: '2.0'
                  description: JSON-RPC version
                id:
                  type: number
                  description: Request identifier
                method:
                  type: string
                  example: ''
                  description: Method name
                params:
                  type: object
                  properties:
                    access_token:
                      type: string
                      description: Ключ сессии аутентификации
                      example: example_string
                    user_id:
                      type: number
                      description: Уникальный идентификатор пользователя клиента агента
                        от имени которого делается запрос
                      example: 123
                    name:
                      type: string
                      description: Название рекламной кампании
                      example: example_string
                    description:
                      type: string
                      description: Описание рекламной кампании
                      maxLength: 255
                      example: example_string
                    status:
                      type: string
                      description: Статус рекламной кампании
                      enum:
                      - active
                      - inactive
                      example: active
                    site_id:
                      type: number
                      description: Уникальный идентификатор сайта
                      example: 123
                    campaign_conditions:
                      type: object
                      description: Условия рекламной кампании.
                    site_blocks:
                      type: array
                      description: Настройки привязки номера к блоку на сайте Если
                        блоки номеров сайта не указаны, то они не настраиваются, т.е.
                        считаются не настроенными Если site_blocks задан одновременно
                        с status = inactive, то будет возвращаться ошибка `invalid_parameters_combination`
                    site_block_id:
                      type: number
                      description: Уникальный идентификатор блока номеров
                      example: 123
                    phone_number_id:
                      type: number
                      description: Уникальный идентификатор виртуального номера. Чтобы
                        получить список доступных виртуальных номеров необходимо использовать
                        метод get.campaign_available_phone_numbers Если указан id
                        который не возвращается методом get.campaign_available_phone_numbers,
                        то будет возвращена ошибка с мнемоникой "entity_not_found".
                        Номер с type = call_tracking может использоваться только в
                        одной рекламной кампании. Если номер уже используется в другой
                        рекламной кампании, то будет возвращена ошибка `already_in_use`
                      example: 123
                    redirection_phone_number_id:
                      type: number
                      description: Уникальный идентификатор номера переадресации.
                        Номер переадресации используется только в том случае, если
                        параметр phone_number_id имеет тип `call_tracking`. Список
                        доступных номеров можно получить методом get.campaign_available_redirection_phone_numbers.
                        Обязателен для заполнения, если в параметре phone_number_id
                        указан виртуальный номер с типом "call_tracking". Если это
                        не так, то будет возвращена ошибка с мнемоникой "required_parameter_missed".
                        Если параметр задан и в phone_number_id указан виртуальный
                        номер с типом "va", то будет возвращаться ошибка `invalid_parameters_combination`
                        В параметре могут быть указаны только номера переадресации,
                        которые возвращаются методом get.campaign_available_redirection_phone_numbers.
                        Если это не так, то будет возвращаться ошибка с мнемоникой
                        "invalid_parameter_value" Доступен, если подключен компонент
                        "va". Если параметр будет заполнен и у вас отсутствует компонент
                        "va", то будет возвращена ошибка с мнемоникой "parameter_component_disabled"
                      example: 123
                    dynamic_call_tracking_enabled:
                      type: boolean
                      description: Активация динамический коллтрекинг. В пул динамического
                        коллтрекинга можно подключить только свободные номера без
                        флага "Использовать в ВАТС" в том же коде, что и номер блока
                        рекламной кампании по умолчанию. При отсутствии необходимого
                        количества номеров они будут автоматически куплены. Звонки
                        на номера из пула динамического коллтрекинга будут обрабатываться
                        по правилам обработки звонков на номер блока рекламной кампании
                        по умолчанию. Может принимать значение "true", если параметр
                        phone_number_id = va | call_tracking. Если это не так, то
                        будет возвращена ошибка с мнемоникой "invalid_parameters_combination"
                        Если Вы используете этот параметр, но у вас не подключен компонент
                        "dynamic_call_tracking", то Вам вернется ошибка с мнемоникой
                        "parameter_component_disabled" Если задан одновременно status
                        = inactive, то будет возвращена ошибка `invalid_parameters_combination`
                        Если параметр dynamic_call_tracking_enabled имеет значение
                        "true", то параметр dynamic_call_tracking обязателен к заполнению.
                        Будет возвращена ошибка "invalid_parameters_combination".
                      enum:
                      - 'true'
                      - 'false'
                      example: 'true'
                    dynamic_call_tracking:
                      type: object
                      description: Настройка динамический коллтрекинг. Обязателен
                        к заполнению, если параметр dynamic_call_tracking_enabled
                        у хоть одного блока имеет значение "true" иначе будет возвращена
                        ошибка с мнемоникой "invalid_parameters_combination" Если
                        Вы используете этот параметр, но у вас не подключен компонент
                        "dynamic_call_tracking", то Вам вернется ошибка с мнемоникой
                        "parameter_component_disabled"
                    reservation_time:
                      type: string
                      description: Значение по умолчанию "15m". Период, на который
                        номер закрепляется за посетителем сайта. По истечении указанного
                        времени номер закрепляется за новым посетителем (или остается
                        за текущим в случае наличия свободных номеров коллтрекинга).
                      enum:
                      - 5m
                      - 10m
                      - 15m
                      - 20m
                      - 30m
                      - 1h
                      - 2h
                      - 4h
                      - 8h
                      - 1d
                      - 1w
                      example: 5m
                    count_virtual_numbers:
                      type: number
                      description: Количество номеров необходимое для работы динамического
                        коллтрекинга в одном блоке. Указанное количество номеров будет
                        куплено.
                      minimum: 1
                      example: 123
                    count_visits:
                      type: number
                      description: Количество посещений по рекламной кампании в сутки
                      minimum: 1
                      example: 123
                    group_conditions:
                      type: array
                      description: Группа условий рекламной кампании
                      maxItems: 30
                    conditions:
                      type: array
                      description: Условия рекламной кампании в группе условий
                      maxItems: 50
                    type:
                      type: string
                      description: Условия рекламной кампании в группе условий include
                        - включает exclude - исключает
                      enum:
                      - include
                      - exclude
                      example: include
                    campaign_parameter:
                      type: string
                      description: Список допустимых значений и возможных операторов
                        см. в таблице "Список параметров и их операторов"
                    value:
                      type: string
                      description: Значение. Для некоторых campaign_parameter может
                        быть свой список допустимых значений см. в таблице "Список
                        параметров и их операторов"
                      example: example_string
                    operator:
                      type: string
                      description: Оператор в условии. Зависит от используемого параметра
                        campaign_parameter см. в таблице "Список параметров и их операторов"
                        "=" - точно соответствует "sub" - включает "~" - регулярное
                        выражение
                      enum:
                      - '='
                      - sub
                      - '~'
                      example: '='
                  required:
                  - access_token
                  - name
                  - site_id
                  - site_block_id
                  - phone_number_id
                  - count_virtual_numbers
                  - count_visits
                  - group_conditions
                  - conditions
                  - type
                  - campaign_parameter
                  - value
                  - operator
              required:
              - jsonrpc
              - id
              - method
              - params
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  jsonrpc:
                    type: string
                    example: '2.0'
                    description: JSON-RPC version
                  id:
                    type: number
                    description: Request identifier
                  result:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: number
                            description: Уникальный идентификатор рекламной кампании
                            example: 123
                        required: []
                      metadata:
                        type: object
                        description: Response metadata
                    required:
                    - data
                    - metadata
                required:
                - jsonrpc
                - id
                - result
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  jsonrpc:
                    type: string
                  id:
                    type: number
                  error:
                    type: object
                    properties:
                      code:
                        type: number
                      message:
                        type: string
                      data:
                        type: object
x-access: Агент, Клиент
x-errors:
  errors: []
  error_references:
  - text: '"Список ошибок для методов с глаголом create"'
    href: ../..#_changeErrors
