openapi: 3.0.0
info:
  title: Загрузка сессий
  version: 1.0.0
  description: Загрузка сессий
paths:
  /upload.sessions:
    post:
      summary: Загрузка сессий
      description: 'Загрузка сессий


        **Доступ:** Агент, Клиент


        **Параметры запроса:** 42


        - `access_token` (string) (обязательный): Ключ сессии аутентификации


        - `user_id` (number) (опциональный): Уникальный идентификатор пользователя
        клиента агента от имени которого делается запрос


        - `ext_id` (string) (обязательный): Уникальный идентификатор сессии во внешней
        системе. Дубликаты отбрасываются в момент загрузки сессий в базу данных. Для
        сопоставления ext_id и внутреннего id сессии используйте метод "get.visitor_sessions_report"


        - `site_id` (number) (обязательный): Уникальный идентификатор сайта


        - `date_time` (iso8601) (обязательный): Дата и время сессии.Данные будут скорректированы
        с учетом указанной таймзоны в личном кабинете. Дата не должна быть больше
        текущего времени и меньше 2011-01-01 00:00:00


        - `visitor_id` (number) (опциональный): Уникальный идентификатор посетителя


        - `is_visitor_new` (boolean) (обязательный): Является ли посетитель новым


        - `duration` (number) (опциональный): Продолжительность сессии, значение в
        секундах


        - `visitor_ip_address` (string) (обязательный): IP-адрес посетителя


        - `campaign_id` (number) (опциональный): Уникальный идентификатор рекламной
        кампании. Если не указано, то попытаемся определить кампанию по переданным
        параметрам. Если не смогли определить, то сессия присваивается рекламной кампании
        c campaign_id = -1 Посетители без рекламной капании


        - `visitor_device` (enum) (опциональный): Устройство посетителя


        - `visitor_browser_name` (string) (опциональный): Браузер посетителя


        - `visitor_browser_version` (string) (опциональный): Версия браузера посетителя


        - `visitor_os_name` (string) (опциональный): Название операционной системы
        посетителя


        - `visitor_os_version` (string) (опциональный): Версия операционной системы
        посетителя


        - `visitor_screen` (string) (опциональный): Разрешение монитора посетителя


        - `visitor_language` (string) (опциональный): Локализация устройства посетителя


        - `search_engine` (string) (опциональный): Поисковая система


        - `search_query` (string) (опциональный): Поисковый запрос


        - `ua_client_id` (string) (опциональный): Уникальный идентификатор в Universal
        Analytics


        - `ym_client_id` (string) (опциональный): Уникальный идентификатор пользователя
        Яндекс.Метрики


        - `referrer` (string) (опциональный): Источник перехода


        - `utm_source` (string) (опциональный): UTM-source


        - `utm_medium` (string) (опциональный): UTM-medium


        - `utm_term` (string) (опциональный): UTM-term


        - `utm_content` (string) (опциональный): UTM-content


        - `utm_campaign` (string) (опциональный): UTM-campaign


        - `utm_referrer` (string) (опциональный): Источник перехода на сайт


        - `utm_expid` (string) (опциональный): Идентификатор эксперимента в Google
        Analytics


        - `openstat_ad` (string) (опциональный): Идентификатор рекламного объявления


        - `openstat_campaign` (string) (опциональный): Идентификатор рекламной кампании


        - `openstat_service` (string) (опциональный): Идентификатор сервиса, предоставляющего
        услуги


        - `openstat_source` (string) (опциональный): Идентификатор площадки, раздела,
        страницы, места на странице, на котором было показано соответствующее рекламное
        объявление


        - `gclid` (string) (опциональный): Google Click Identifier


        - `yclid` (string) (опциональный): Yandex Click Identifier


        - `ymclid` (string) (опциональный): Yandex Market Click Identifier


        - `ef_id` (string) (опциональный): Используется для разметки ссылок в системе
        управления контекстной рекламой AdLense


        - `tag_from` (string) (опциональный): Пользовательская метка


        - `cm_id` (string) (опциональный): Метка добавляемая в url объявлений внешних
        рекламных систем при интеграции. Смотрите подробнее компоновку метки cm_id
        для конкретной рекламной системы.


        - `adv_system` (number) (опциональный): Идентификатор рекламной системы


        - `entrance_page_url` (string) (опциональный): URL страницы посещения(Страница
        входа).


        - `entrance_page_title` (string) (опциональный): Название страницы посещения.
        Если не передано будет null в карточке клиента'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                jsonrpc:
                  type: string
                  example: '2.0'
                  description: JSON-RPC version
                id:
                  type: number
                  description: Request identifier
                method:
                  type: string
                  example: ''
                  description: Method name
                params:
                  type: object
                  properties:
                    access_token:
                      type: string
                      description: Ключ сессии аутентификации
                      example: example_string
                    user_id:
                      type: number
                      description: Уникальный идентификатор пользователя клиента агента
                        от имени которого делается запрос
                      example: 123
                    ext_id:
                      type: string
                      description: Уникальный идентификатор сессии во внешней системе.
                        Дубликаты отбрасываются в момент загрузки сессий в базу данных.
                        Для сопоставления ext_id и внутреннего id сессии используйте
                        метод "get.visitor_sessions_report"
                      example: example_string
                    site_id:
                      type: number
                      description: Уникальный идентификатор сайта
                      example: 123
                    date_time:
                      type: string
                      description: Дата и время сессии.Данные будут скорректированы
                        с учетом указанной таймзоны в личном кабинете. Дата не должна
                        быть больше текущего времени и меньше 2011-01-01 00:00:00
                      enum:
                      - YYYY-MM-DD hh:mm:ss
                      example: YYYY-MM-DD hh:mm:ss
                    visitor_id:
                      type: number
                      description: Уникальный идентификатор посетителя
                      enum:
                      - Может быть только с того же site_id
                      example: Может быть только с того же site_id
                    is_visitor_new:
                      type: boolean
                      description: Является ли посетитель новым
                      example: true
                    duration:
                      type: number
                      description: Продолжительность сессии, значение в секундах
                      enum:
                      - start_time + duration должен быть не более 23:59:59 date_time
                      example: start_time + duration должен быть не более 23:59:59
                        date_time
                    visitor_ip_address:
                      type: string
                      description: IP-адрес посетителя
                      example: example_string
                    campaign_id:
                      type: number
                      description: Уникальный идентификатор рекламной кампании. Если
                        не указано, то попытаемся определить кампанию по переданным
                        параметрам. Если не смогли определить, то сессия присваивается
                        рекламной кампании c campaign_id = -1 Посетители без рекламной
                        капании
                      example: 123
                    visitor_device:
                      type: string
                      description: Устройство посетителя
                      enum:
                      - desktop
                      - mobile
                      - tablet
                      - other
                      example: desktop
                    visitor_browser_name:
                      type: string
                      description: Браузер посетителя
                      enum:
                      - Например Chrome
                      example: Например Chrome
                    visitor_browser_version:
                      type: string
                      description: Версия браузера посетителя
                      example: example_string
                    visitor_os_name:
                      type: string
                      description: Название операционной системы посетителя
                      example: example_string
                    visitor_os_version:
                      type: string
                      description: Версия операционной системы посетителя
                      example: example_string
                    visitor_screen:
                      type: string
                      description: Разрешение монитора посетителя
                      enum:
                      - Например 1440x900
                      example: Например 1440x900
                    visitor_language:
                      type: string
                      description: Локализация устройства посетителя
                      enum:
                      - Например ru-RU
                      example: Например ru-RU
                    search_engine:
                      type: string
                      description: Поисковая система
                      example: example_string
                    search_query:
                      type: string
                      description: Поисковый запрос
                      example: example_string
                    ua_client_id:
                      type: string
                      description: Уникальный идентификатор в Universal Analytics
                      example: example_string
                    ym_client_id:
                      type: string
                      description: Уникальный идентификатор пользователя Яндекс.Метрики
                      example: example_string
                    referrer:
                      type: string
                      description: Источник перехода
                      example: example_string
                    utm_source:
                      type: string
                      description: UTM-source
                      example: example_string
                    utm_medium:
                      type: string
                      description: UTM-medium
                      example: example_string
                    utm_term:
                      type: string
                      description: UTM-term
                      example: example_string
                    utm_content:
                      type: string
                      description: UTM-content
                      example: example_string
                    utm_campaign:
                      type: string
                      description: UTM-campaign
                      example: example_string
                    utm_referrer:
                      type: string
                      description: Источник перехода на сайт
                      example: example_string
                    utm_expid:
                      type: string
                      description: Идентификатор эксперимента в Google Analytics
                      example: example_string
                    openstat_ad:
                      type: string
                      description: Идентификатор рекламного объявления
                      example: example_string
                    openstat_campaign:
                      type: string
                      description: Идентификатор рекламной кампании
                      example: example_string
                    openstat_service:
                      type: string
                      description: Идентификатор сервиса, предоставляющего услуги
                      example: example_string
                    openstat_source:
                      type: string
                      description: Идентификатор площадки, раздела, страницы, места
                        на странице, на котором было показано соответствующее рекламное
                        объявление
                      example: example_string
                    gclid:
                      type: string
                      description: Google Click Identifier
                      example: example_string
                    yclid:
                      type: string
                      description: Yandex Click Identifier
                      example: example_string
                    ymclid:
                      type: string
                      description: Yandex Market Click Identifier
                      example: example_string
                    ef_id:
                      type: string
                      description: Используется для разметки ссылок в системе управления
                        контекстной рекламой AdLense
                      example: example_string
                    tag_from:
                      type: string
                      description: Пользовательская метка
                      example: example_string
                    cm_id:
                      type: string
                      description: Метка добавляемая в url объявлений внешних рекламных
                        систем при интеграции. Смотрите подробнее компоновку метки
                        cm_id для конкретной рекламной системы.
                      example: example_string
                    adv_system:
                      type: number
                      description: Идентификатор рекламной системы
                      enum:
                      - 1 - Яндекс.Директ
                      - 2 - Google Ads
                      - 3 - Бегун
                      - 4 - Яндекс.Маркет
                      - 5 - Aport
                      - 6 - Facebook Ads
                      - 7 - VK Ads
                      - 8 - myTarget Ads
                      example: 1 - Яндекс.Директ
                    entrance_page_url:
                      type: string
                      description: URL страницы посещения(Страница входа).
                      example: example_string
                    entrance_page_title:
                      type: string
                      description: Название страницы посещения. Если не передано будет
                        null в карточке клиента
                      example: example_string
                  required:
                  - access_token
                  - ext_id
                  - site_id
                  - date_time
                  - is_visitor_new
                  - visitor_ip_address
              required:
              - jsonrpc
              - id
              - method
              - params
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  jsonrpc:
                    type: string
                    example: '2.0'
                    description: JSON-RPC version
                  id:
                    type: number
                    description: Request identifier
                  result:
                    type: object
                    properties:
                      data:
                        type: object
                      metadata:
                        type: object
                        description: Response metadata
                    required:
                    - data
                    - metadata
                required:
                - jsonrpc
                - id
                - result
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  jsonrpc:
                    type: string
                  id:
                    type: number
                  error:
                    type: object
                    properties:
                      code:
                        type: number
                      message:
                        type: string
                      data:
                        type: object
x-access: Агент, Клиент
